<section class="quiz">
  <app-container>
    <form (ngSubmit)="submitQuiz()" *ngIf="this.questions && this.questions.length > 0">
      <h2>{{ "title_quiz" | translate }}</h2>
      <h3 *ngIf="this.currentStep < this.maxSteps">{{ "part" | translate }} {{this.currentStep + 1}} / {{this.maxSteps}}
      </h3>
      <!-- Exibir perguntas da etapa atual -->
      <div *ngFor="let question of getQuestionsForStep(); let i = index">
        <hr>
        <app-fieldset
          [class.strikethrough]="question.response !== '' && question.response !== null && question.response !== undefined">
          <h4>{{ question.question }}</h4>
          <p><em>{{ question.example }}</em></p>
          <p>{{ question.frequency_and_context }}</p>

          <label>
            <input type="radio" [(ngModel)]="question.response" [value]="true" name="response{{ i }}"
              (blur)="checkRequired(question)" />
            <span id="yes-option-{{ i }}">{{ "yes" | translate }}</span>
          </label>

          <label>
            <input type="radio" [(ngModel)]="question.response" [value]="false" name="response{{ i }}"
              (blur)="checkRequired(question)" />
            <span id="no-option-{{ i }}">{{ "no" | translate }}</span>
          </label>

          <app-error-message
            *ngIf="(question.response !== true && question.response !== false) && submitted === true"></app-error-message>
        </app-fieldset>
      </div>

      <!-- Botões de navegação -->
      <div class="navigation-buttons">
        <div class="send action" *ngIf="this.currentStep < this.maxSteps">
          <app-button *ngIf="this.currentStep < this.maxSteps" (click)="nextStep()" [disabled]="!isFormValid()">
            {{ "next" | translate }}
          </app-button>
          <app-button *ngIf="this.currentStep >= 1 && this.currentStep <= this.maxSteps" (click)="backStep()">
            {{ "back" | translate }}
          </app-button>
        </div>

        <div class="send action" *ngIf="this.currentStep >= this.maxSteps">
          <h3>{{ "title_quiz_send" | translate }}</h3>
          <app-button [disabled]="!isFormValid()" (click)="submitQuiz()">
            {{ "calculate_results" | translate }}
          </app-button>
          <app-button *ngIf="this.currentStep >= 1 && this.currentStep <= this.maxSteps" (click)="backStep()">
            {{ "revise_quiz" | translate }}
          </app-button>
        </div>
      </div>
    </form>
  </app-container>
</section>
